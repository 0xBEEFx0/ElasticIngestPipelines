[
  {
    "set": {
      "field": "event.ingested",
      "value": "{{_ingest.timestamp}}"
    }
  },
  {
    "grok": {
      "field": "message",
      "pattern_definitions": {
        "ANY": ".*",
        "AUDIT_TYPE": "type=%{NOTSPACE:auditd.log.record_type}",
        "AUDIT_NODE": "node=%{IPORHOST:auditd.log.node} ",
        "AUDIT_PREFIX": "^(?:%{AUDIT_NODE})?%{AUDIT_TYPE} msg=audit\\(%{NUMBER:auditd.log.epoch}:%{NUMBER:auditd.log.sequence}\\):(%{DATA})?",
        "AUDIT_KEY_VALUES": "%{WORD}=%{GREEDYDATA}"
      },
      "patterns": [
        "%{AUDIT_PREFIX} %{AUDIT_KEY_VALUES:auditd.log.kv} old auid=%{NUMBER:auditd.log.old_auid} new auid=%{NUMBER:auditd.log.new_auid} old ses=%{NUMBER:auditd.log.old_ses} new ses=%{NUMBER:auditd.log.new_ses}",
        "%{AUDIT_PREFIX} %{AUDIT_KEY_VALUES:auditd.log.kv} msg=['\"]([^=]*\\s)?%{ANY:auditd.log.sub_kv}['\"]",
        "%{AUDIT_PREFIX} %{AUDIT_KEY_VALUES:auditd.log.kv}",
        "%{AUDIT_PREFIX}",
        "%{AUDIT_TYPE} %{AUDIT_KEY_VALUES:auditd.log.kv}"
      ]
    }
  },
  {
    "kv": {
      "value_split": "=",
      "target_field": "auditd.log",
      "field": "auditd.log.kv",
      "field_split": "\\s+"
    }
  },
  {
    "kv": {
      "field": "auditd.log.sub_kv",
      "field_split": "\\s+(?=[^\\s]+=)",
      "value_split": "=",
      "target_field": "auditd.log",
      "ignore_missing": true
    }
  },
  {
    "rename": {
      "field": "message",
      "target_field": "event.original",
      "ignore_failure": true
    }
  },
  {
    "date": {
      "field": "auditd.log.epoch",
      "target_field": "@timestamp",
      "formats": [
        "UNIX"
      ],
      "ignore_failure": true
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.old-auid",
      "target_field": "auditd.log.old_auid"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.old-ses",
      "target_field": "auditd.log.old_ses"
    }
  },
  {
    "script": {
      "lang": "painless",
      "source": "String trimQuotes(def singleQuote, def doubleQuote, def v) {\n    if (v.startsWith(singleQuote) || v.startsWith(doubleQuote)) {\n        v = v.substring(1, v.length());\n    }\n    if (v.endsWith(singleQuote) || v.endsWith(doubleQuote)) {\n        v = v.substring(0, v.length()-1);\n    }\n    return v;\n}\n\nboolean isHexAscii(String v) {\n    def len = v.length();\n\n    if (len == 0 || len % 2 != 0) {\n        return false;\n    }\n\n    for (int i = 0 ; i < len ; i++) {\n        if (Character.digit(v.charAt(i), 16) == -1) {\n            return false;\n        }\n    }\n    return true;\n}\n\nString convertHexToString(String hex) {\n    StringBuilder sb = new StringBuilder();\n    boolean needed_encoding = false;\n\n    for (int i=0; i < hex.length() - 1; i+=2) {\n        int cp = Integer.parseInt(hex.substring(i, (i +2)), 16);\n        if (cp < 33 || cp == 34 || cp == 127) {\n            needed_encoding = true;\n        }\n        if (cp < 32 || cp == 127) {\n            sb.append('^');\n            cp ^= 64;\n        }\n        sb.append((char)cp);\n    }\n    if (needed_encoding) {\n        return sb.toString();\n    }\n    return hex;\n}\n\ndef possibleHexKeys = [\"exe\", \"cmd\", \"data\", \"path\", \"comm\", \"file\", \"name\", \"watch\", \"cwd\", \"acct\", \"dir\", \"vm\", \"old-chardev\", \"new-chardev\", \"old-disk\", \"new-disk\", \"old-fs\", \"new-fs\", \"old-net\", \"new-net\", \"device\", \"cgroup\", \"apparmor\", \"operation\", \"denied_mask\", \"info\", \"profile\", \"requested_mask\", \"old-rng\", \"new-rng\", \"ocomm\", \"grp\", \"new_group\", \"invalid_context\", \"sw\", \"root_dir\", \"proctitle\"];\ndef audit = ctx.auditd.get(\"log\");\nIterator entries = audit.entrySet().iterator();\n\nwhile (entries.hasNext()) {\n    def e = entries.next();\n    def k = e.getKey();\n    def v = e.getValue();\n\n    // Remove entries whose value is ?\n    if (v == \"?\" || v == \"(null)\" || v == \"\") {\n        entries.remove();\n        continue;\n    }\n\n    // Convert hex values to ASCII.\n    if (possibleHexKeys.contains(k) && isHexAscii(v)) {\n        v = convertHexToString(v);\n        audit.put(k, v);\n    }\n\n    // Trim quotes.\n    if (v instanceof String) {\n        v = trimQuotes(params.single_quote, params.double_quote, v);\n        audit.put(k, v);\n    }\n\n    // Convert arch.\n    if (k == \"arch\" && v == \"c000003e\") {\n        audit.put(k, \"x86_64\");\n    }\n}\n",
      "params": {
        "single_quote": "'",
        "double_quote": "\""
      }
    }
  },
  {
    "convert": {
      "field": "auditd.log.sequence",
      "type": "long",
      "ignore_missing": true
    }
  },
  {
    "convert": {
      "field": "auditd.log.lport",
      "type": "long",
      "ignore_missing": true
    }
  },
  {
    "convert": {
      "ignore_missing": true,
      "field": "auditd.log.rport",
      "type": "long"
    }
  },
  {
    "convert": {
      "field": "auditd.log.entries",
      "type": "long",
      "ignore_missing": true
    }
  },
  {
    "convert": {
      "ignore_missing": true,
      "field": "auditd.log.dst_prefixlen",
      "type": "long"
    }
  },
  {
    "convert": {
      "ignore_missing": true,
      "field": "auditd.log.ksize",
      "type": "long"
    }
  },
  {
    "convert": {
      "ignore_missing": true,
      "field": "auditd.log.size",
      "type": "long"
    }
  },
  {
    "convert": {
      "type": "long",
      "ignore_missing": true,
      "field": "auditd.log.src_prefixlen"
    }
  },
  {
    "set": {
      "field": "event.kind",
      "value": "event"
    }
  },
  {
    "script": {
      "lang": "painless",
      "ignore_failure": true,
      "params": {
        "syscalls": {
          "settimeofday": [
            {
              "event": {
                "action": [
                  "changed-system-time"
                ],
                "category": [
                  "host"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "rmdir": [
            {
              "event": {
                "action": [
                  "deleted"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "deletion"
                ]
              }
            }
          ],
          "futimens": [
            {
              "event": {
                "action": [
                  "changed-timestamp-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "faccessat": [
            {
              "event": {
                "action": [
                  "checked-metadata-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "fgetxattr": [
            {
              "event": {
                "action": [
                  "checked-metadata-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "setdomainname": [
            {
              "event": {
                "type": [
                  "change"
                ],
                "action": [
                  "changed-system-name"
                ],
                "category": [
                  "host"
                ]
              }
            }
          ],
          "write": [
            {
              "event": {
                "type": [
                  "change"
                ],
                "action": [
                  "wrote-to-file"
                ],
                "category": [
                  "file"
                ]
              }
            }
          ],
          "access": [
            {
              "event": {
                "action": [
                  "checked-metadata-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "mmap2": [
            {
              "event": {
                "type": [
                  "info"
                ],
                "action": [
                  "allocated-memory"
                ],
                "category": [
                  "process"
                ]
              }
            }
          ],
          "sendmsg": [
            {
              "event": {
                "action": [
                  "sent-to"
                ],
                "category": [
                  "network"
                ],
                "type": [
                  "connection",
                  "info"
                ]
              }
            }
          ],
          "ftruncate": [
            {
              "event": {
                "category": [
                  "file"
                ],
                "type": [
                  "change"
                ],
                "action": [
                  "opened-file"
                ]
              }
            }
          ],
          "bind": [
            {
              "event": {
                "category": [
                  "network"
                ],
                "type": [
                  "start"
                ],
                "action": [
                  "bound-socket"
                ]
              }
            }
          ],
          "futimesat": [
            {
              "event": {
                "action": [
                  "changed-timestamp-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "chown": [
            {
              "event": {
                "action": [
                  "changed-file-ownership-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "fstat": [
            {
              "event": {
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ],
                "action": [
                  "checked-metadata-of"
                ]
              }
            }
          ],
          "seteuid": [
            {
              "event": {
                "action": [
                  "changed-identity-of"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "setresgid": [
            {
              "event": {
                "type": [
                  "change"
                ],
                "action": [
                  "changed-identity-of"
                ],
                "category": [
                  "process"
                ]
              }
            }
          ],
          "stime": [
            {
              "event": {
                "action": [
                  "changed-system-time"
                ],
                "category": [
                  "host"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "umount": [
            {
              "event": {
                "type": [
                  "deletion"
                ],
                "action": [
                  "unmounted"
                ],
                "category": [
                  "file"
                ]
              }
            }
          ],
          "fremovexattr": [
            {
              "event": {
                "action": [
                  "changed-file-attributes-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "rename": [
            {
              "event": {
                "type": [
                  "change"
                ],
                "action": [
                  "renamed"
                ],
                "category": [
                  "file"
                ]
              }
            }
          ],
          "symlink": [
            {
              "event": {
                "category": [
                  "file"
                ],
                "type": [
                  "creation"
                ],
                "action": [
                  "symlinked"
                ]
              }
            }
          ],
          "kill": [
            {
              "event": {
                "action": [
                  "killed-pid"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "end"
                ]
              }
            }
          ],
          "setfsgid": [
            {
              "event": {
                "action": [
                  "changed-identity-of"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "renameat": [
            {
              "event": {
                "action": [
                  "renamed"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "sched_setattr": [
            {
              "event": {
                "action": [
                  "adjusted-scheduling-policy-of"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "setreuid": [
            {
              "event": {
                "action": [
                  "changed-identity-of"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "sched_setscheduler": [
            {
              "event": {
                "action": [
                  "adjusted-scheduling-policy-of"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "init_module": [
            {
              "event": {
                "type": [
                  "start"
                ],
                "action": [
                  "loaded-kernel-module"
                ],
                "category": [
                  "driver"
                ]
              }
            }
          ],
          "listen": [
            {
              "event": {
                "action": [
                  "listen-for-connections"
                ],
                "category": [
                  "network"
                ],
                "type": [
                  "start"
                ]
              }
            }
          ],
          "truncate": [
            {
              "event": {
                "action": [
                  "opened-file"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "fchownat": [
            {
              "event": {
                "action": [
                  "changed-file-ownership-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "tkill": [
            {
              "event": {
                "category": [
                  "process"
                ],
                "type": [
                  "end"
                ],
                "action": [
                  "killed-pid"
                ]
              }
            }
          ],
          "utime": [
            {
              "event": {
                "action": [
                  "changed-timestamp-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "setresuid": [
            {
              "event": {
                "action": [
                  "changed-identity-of"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "tgkill": [
            {
              "event": {
                "action": [
                  "killed-pid"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "end"
                ]
              }
            }
          ],
          "mknodat": [
            {
              "event": {
                "type": [
                  "creation"
                ],
                "action": [
                  "make-device"
                ],
                "category": [
                  "file"
                ]
              }
            }
          ],
          "setgid": [
            {
              "event": {
                "action": [
                  "changed-identity-of"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "fchmod": [
            {
              "event": {
                "type": [
                  "change"
                ],
                "action": [
                  "changed-file-permissions-of"
                ],
                "category": [
                  "file"
                ]
              }
            }
          ],
          "setuid": [
            {
              "event": {
                "action": [
                  "changed-identity-of"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "fchmodat": [
            {
              "event": {
                "action": [
                  "changed-file-permissions-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "fstatfs": [
            {
              "event": {
                "type": [
                  "info"
                ],
                "action": [
                  "checked-filesystem-metadata-of"
                ],
                "category": [
                  "file"
                ]
              }
            }
          ],
          "chmod": [
            {
              "event": {
                "type": [
                  "change"
                ],
                "action": [
                  "changed-file-permissions-of"
                ],
                "category": [
                  "file"
                ]
              }
            }
          ],
          "lgetxattr": [
            {
              "event": {
                "action": [
                  "checked-metadata-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "renameat2": [
            {
              "event": {
                "action": [
                  "renamed"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "accept": [
            {
              "event": {
                "action": [
                  "accepted-connection-from"
                ],
                "category": [
                  "network"
                ],
                "type": [
                  "connection",
                  "start"
                ]
              }
            }
          ],
          "fstatat": [
            {
              "event": {
                "type": [
                  "info"
                ],
                "action": [
                  "checked-metadata-of"
                ],
                "category": [
                  "file"
                ]
              }
            }
          ],
          "readlink": [
            {
              "event": {
                "action": [
                  "opened-file"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "utimensat": [
            {
              "event": {
                "action": [
                  "changed-timestamp-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "delete_module": [
            {
              "event": {
                "action": [
                  "unloaded-kernel-module"
                ],
                "category": [
                  "driver"
                ],
                "type": [
                  "end"
                ]
              }
            }
          ],
          "read": [
            {
              "event": {
                "type": [
                  "info"
                ],
                "action": [
                  "read-file"
                ],
                "category": [
                  "file"
                ]
              }
            }
          ],
          "adjtimex": [
            {
              "event": {
                "category": [
                  "host"
                ],
                "type": [
                  "change"
                ],
                "action": [
                  "changed-system-time"
                ]
              }
            }
          ],
          "setxattr": [
            {
              "event": {
                "action": [
                  "changed-file-attributes-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "umount2": [
            {
              "event": {
                "action": [
                  "unmounted"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "deletion"
                ]
              }
            }
          ],
          "sendto": [
            {
              "event": {
                "action": [
                  "sent-to"
                ],
                "category": [
                  "network"
                ],
                "type": [
                  "connection",
                  "info"
                ]
              }
            }
          ],
          "unlinkat": [
            {
              "event": {
                "category": [
                  "file"
                ],
                "type": [
                  "deletion"
                ],
                "action": [
                  "deleted"
                ]
              }
            }
          ],
          "lstat": [
            {
              "event": {
                "action": [
                  "checked-metadata-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "readlinkat": [
            {
              "event": {
                "action": [
                  "opened-file"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "lremovexattr": [
            {
              "event": {
                "action": [
                  "changed-file-attributes-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "fallocate": [
            {
              "event": {
                "type": [
                  "change"
                ],
                "action": [
                  "opened-file"
                ],
                "category": [
                  "file"
                ]
              }
            }
          ],
          "sendmmsg": [
            {
              "event": {
                "category": [
                  "network"
                ],
                "type": [
                  "connection",
                  "info"
                ],
                "action": [
                  "sent-to"
                ]
              }
            }
          ],
          "recv": [
            {
              "event": {
                "type": [
                  "connection",
                  "info"
                ],
                "action": [
                  "received-from"
                ],
                "category": [
                  "network"
                ]
              }
            }
          ],
          "recvfrom": [
            {
              "event": {
                "category": [
                  "network"
                ],
                "type": [
                  "connection",
                  "info"
                ],
                "action": [
                  "received-from"
                ]
              }
            }
          ],
          "fchown": [
            {
              "event": {
                "action": [
                  "changed-file-ownership-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "symlinkat": [
            {
              "event": {
                "type": [
                  "creation"
                ],
                "action": [
                  "symlinked"
                ],
                "category": [
                  "file"
                ]
              }
            }
          ],
          "sethostname": [
            {
              "event": {
                "action": [
                  "changed-system-name"
                ],
                "category": [
                  "host"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "mkdirat": [
            {
              "event": {
                "action": [
                  "created-directory"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "creation"
                ]
              }
            }
          ],
          "setfsuid": [
            {
              "event": {
                "action": [
                  "changed-identity-of"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "getxattr": [
            {
              "event": {
                "action": [
                  "checked-metadata-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "mmap": [
            {
              "event": {
                "action": [
                  "allocated-memory"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "setegid": [
            {
              "event": {
                "action": [
                  "changed-identity-of"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "lchown": [
            {
              "event": {
                "action": [
                  "changed-file-ownership-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "utimes": [
            {
              "event": {
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ],
                "action": [
                  "changed-timestamp-of"
                ]
              }
            }
          ],
          "unlink": [
            {
              "event": {
                "action": [
                  "deleted"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "deletion"
                ]
              }
            }
          ],
          "stat": [
            {
              "event": {
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ],
                "action": [
                  "checked-metadata-of"
                ]
              }
            }
          ],
          "mkdir": [
            {
              "event": {
                "action": [
                  "created-directory"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "creation"
                ]
              }
            }
          ],
          "send": [
            {
              "event": {
                "action": [
                  "sent-to"
                ],
                "category": [
                  "network"
                ],
                "type": [
                  "connection",
                  "info"
                ]
              }
            }
          ],
          "execve": [
            {
              "event": {
                "category": [
                  "process"
                ],
                "type": [
                  "start"
                ],
                "action": [
                  "executed"
                ]
              }
            }
          ],
          "clock_settime": [
            {
              "event": {
                "category": [
                  "host"
                ],
                "type": [
                  "change"
                ],
                "action": [
                  "changed-system-time"
                ]
              }
            }
          ],
          "sched_setparam": [
            {
              "event": {
                "action": [
                  "adjusted-scheduling-policy-of"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "brk": [
            {
              "event": {
                "type": [
                  "info"
                ],
                "action": [
                  "allocated-memory"
                ],
                "category": [
                  "process"
                ]
              }
            }
          ],
          "*": [
            {
              "event": {
                "category": [
                  "process"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "lsetxattr": [
            {
              "event": {
                "action": [
                  "changed-file-attributes-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "stat64": [
            {
              "event": {
                "action": [
                  "checked-metadata-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "recvmmsg": [
            {
              "event": {
                "type": [
                  "connection",
                  "info"
                ],
                "action": [
                  "received-from"
                ],
                "category": [
                  "network"
                ]
              }
            }
          ],
          "fsetxattr": [
            {
              "event": {
                "action": [
                  "changed-file-attributes-of"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "statfs": [
            {
              "event": {
                "type": [
                  "info"
                ],
                "action": [
                  "checked-filesystem-metadata-of"
                ],
                "category": [
                  "file"
                ]
              }
            }
          ],
          "mount": [
            {
              "event": {
                "action": [
                  "mounted"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "creation"
                ]
              }
            }
          ],
          "execveat": [
            {
              "event": {
                "action": [
                  "executed"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "start"
                ]
              }
            }
          ],
          "accept4": [
            {
              "event": {
                "action": [
                  "accepted-connection-from"
                ],
                "category": [
                  "network"
                ],
                "type": [
                  "connection",
                  "start"
                ]
              }
            }
          ],
          "mknod": [
            {
              "event": {
                "type": [
                  "creation"
                ],
                "action": [
                  "make-device"
                ],
                "category": [
                  "file"
                ]
              }
            }
          ],
          "finit_module": [
            {
              "event": {
                "action": [
                  "loaded-kernel-module"
                ],
                "category": [
                  "driver"
                ],
                "type": [
                  "start"
                ]
              }
            }
          ],
          "newfstatat": [
            {
              "event": {
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ],
                "action": [
                  "checked-metadata-of"
                ]
              }
            }
          ],
          "recvmsg": [
            {
              "event": {
                "action": [
                  "received-from"
                ],
                "category": [
                  "network"
                ],
                "type": [
                  "connection",
                  "info"
                ]
              }
            }
          ],
          "openat": [
            {
              "event": {
                "action": [
                  "opened-file"
                ],
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "creat": [
            {
              "event": {
                "category": [
                  "file"
                ],
                "type": [
                  "creation"
                ],
                "action": [
                  "opened-file"
                ]
              }
            }
          ],
          "removexattr": [
            {
              "event": {
                "type": [
                  "change"
                ],
                "action": [
                  "changed-file-attributes-of"
                ],
                "category": [
                  "file"
                ]
              }
            }
          ],
          "connect": [
            {
              "event": {
                "type": [
                  "connection",
                  "start"
                ],
                "action": [
                  "connected-to"
                ],
                "category": [
                  "network"
                ]
              }
            }
          ],
          "open": [
            {
              "event": {
                "category": [
                  "file"
                ],
                "type": [
                  "info"
                ],
                "action": [
                  "opened-file"
                ]
              }
            }
          ],
          "setregid": [
            {
              "event": {
                "action": [
                  "changed-identity-of"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ]
        },
        "types": {
          "NETFILTER_CFG": [
            {
              "event": {
                "action": [
                  "loaded-firewall-rule-to"
                ],
                "category": [
                  "configuration"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "USER_START": [
            {
              "copy": [
                {
                  "to": "user",
                  "from": [
                    "auid"
                  ]
                },
                {
                  "to": "user.effective",
                  "from": [
                    "acct",
                    "id",
                    "uid"
                  ]
                }
              ],
              "event": {
                "action": [
                  "started-session"
                ],
                "category": [
                  "session"
                ],
                "type": [
                  "start"
                ]
              }
            }
          ],
          "ROLE_REMOVE": [
            {
              "event": {
                "action": [
                  "removed-user-role-from"
                ],
                "category": [
                  "iam"
                ],
                "type": [
                  "user",
                  "change"
                ]
              }
            }
          ],
          "USER_AVC": [
            {
              "event": {
                "action": [
                  "access-permission"
                ]
              }
            }
          ],
          "ANOM_LINK": [
            {
              "event": {
                "action": [
                  "used-suspicious-link"
                ]
              }
            }
          ],
          "ANOM_LOGIN_TIME": [
            {
              "event": {
                "action": [
                  "attempted-log-in-during-unusual-hour-to"
                ]
              }
            }
          ],
          "LOGIN": [
            {
              "copy": [
                {
                  "from": [
                    "old_auid",
                    "old-auid"
                  ],
                  "to": "user"
                },
                {
                  "from": [
                    "new-auid",
                    "new_auid",
                    "auid"
                  ],
                  "to": "user.effective"
                }
              ],
              "event": {
                "category": [
                  "authentication"
                ],
                "type": [
                  "start"
                ],
                "action": [
                  "changed-login-id-to"
                ]
              }
            }
          ],
          "USER_MGMT": [
            {
              "event": {
                "type": [
                  "user",
                  "change"
                ],
                "action": [
                  "modified-user-account"
                ],
                "category": [
                  "iam"
                ]
              },
              "copy": [
                {
                  "to": "user",
                  "from": [
                    "auid"
                  ]
                },
                {
                  "from": [
                    "acct",
                    "id",
                    "uid"
                  ],
                  "to": "user.target"
                },
                {
                  "to": "user.effective",
                  "from": [
                    "uid"
                  ]
                }
              ]
            }
          ],
          "USER_SELINUX_ERR": [
            {
              "event": {
                "action": [
                  "access-error"
                ]
              }
            }
          ],
          "VIRT_MIGRATE_OUT": [
            {
              "event": {
                "action": [
                  "migrated-vm-to"
                ],
                "category": [
                  "host"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "DAEMON_CONFIG": [
            {
              "event": {
                "category": [
                  "process",
                  "configuration"
                ],
                "type": [
                  "change"
                ],
                "action": [
                  "changed-auditd-configuration"
                ]
              }
            }
          ],
          "DAC_CHECK": [
            {
              "event": {
                "action": [
                  "access-result"
                ]
              }
            }
          ],
          "CRED_DISP": [
            {
              "copy": [
                {
                  "from": [
                    "auid"
                  ],
                  "to": "user"
                },
                {
                  "from": [
                    "acct",
                    "id",
                    "uid"
                  ],
                  "to": "user.effective"
                }
              ],
              "event": {
                "action": [
                  "disposed-credentials"
                ],
                "category": [
                  "authentication"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "SERVICE_START": [
            {
              "event": {
                "action": [
                  "started-service"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "start"
                ]
              }
            }
          ],
          "USER_ERR": [
            {
              "copy": [
                {
                  "from": [
                    "auid"
                  ],
                  "to": "user"
                },
                {
                  "to": "user.effective",
                  "from": [
                    "acct",
                    "id",
                    "uid"
                  ]
                }
              ],
              "event": {
                "action": [
                  "error"
                ],
                "category": [
                  "authentication"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "GRP_MGMT": [
            {
              "copy": [
                {
                  "from": [
                    "auid"
                  ],
                  "to": "user"
                },
                {
                  "from": [
                    "uid"
                  ],
                  "to": "group"
                },
                {
                  "from": [
                    "uid"
                  ],
                  "to": "user.effective"
                }
              ],
              "event": {
                "category": [
                  "iam"
                ],
                "type": [
                  "group",
                  "change"
                ],
                "action": [
                  "modified-group-account"
                ]
              }
            }
          ],
          "LABEL_LEVEL_CHANGE": [
            {
              "event": {
                "action": [
                  "modified-level-of"
                ]
              }
            }
          ],
          "CRED_ACQ": [
            {
              "event": {
                "category": [
                  "authentication"
                ],
                "type": [
                  "info"
                ],
                "action": [
                  "acquired-credentials"
                ]
              },
              "copy": [
                {
                  "from": [
                    "auid"
                  ],
                  "to": "user"
                },
                {
                  "from": [
                    "acct",
                    "id",
                    "uid"
                  ],
                  "to": "user.effective"
                }
              ]
            }
          ],
          "GRP_AUTH": [
            {
              "copy": [
                {
                  "from": [
                    "auid"
                  ],
                  "to": "user"
                },
                {
                  "from": [
                    "uid"
                  ],
                  "to": "user.effective"
                }
              ],
              "event": {
                "type": [
                  "info"
                ],
                "action": [
                  "authenticated-to-group"
                ],
                "category": [
                  "authentication"
                ]
              }
            }
          ],
          "GRP_CHAUTHTOK": [
            {
              "copy": [
                {
                  "to": "user",
                  "from": [
                    "auid"
                  ]
                },
                {
                  "from": [
                    "uid"
                  ],
                  "to": "user.effective"
                },
                {
                  "from": [
                    "acct",
                    "id",
                    "uid"
                  ],
                  "to": "group"
                }
              ],
              "event": {
                "action": [
                  "changed-group-password"
                ],
                "category": [
                  "iam"
                ],
                "type": [
                  "group",
                  "change"
                ]
              }
            }
          ],
          "VIRT_DESTROY": [
            {
              "event": {
                "category": [
                  "host"
                ],
                "type": [
                  "info"
                ],
                "action": [
                  "deleted-vm-image"
                ]
              }
            }
          ],
          "VIRT_INTEGRITY_CHECK": [
            {
              "event": {
                "action": [
                  "checked-integrity-of"
                ],
                "category": [
                  "host"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "VIRT_MIGRATE_IN": [
            {
              "event": {
                "action": [
                  "migrated-vm-from"
                ],
                "category": [
                  "host"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "SYSTEM_RUNLEVEL": [
            {
              "event": {
                "action": [
                  "changed-to-runlevel"
                ],
                "category": [
                  "host"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "DAEMON_ACCEPT": [
            {
              "event": {
                "type": [
                  "connection",
                  "start"
                ],
                "action": [
                  "remote-audit-connected"
                ],
                "category": [
                  "network"
                ]
              }
            }
          ],
          "DAEMON_START": [
            {
              "event": {
                "action": [
                  "started-audit"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "start"
                ]
              }
            }
          ],
          "VIRT_CONTROL": [
            {
              "event": {
                "type": [
                  "info"
                ],
                "action": [
                  "issued-vm-control"
                ],
                "category": [
                  "host"
                ]
              }
            }
          ],
          "DEL_USER": [
            {
              "copy": [
                {
                  "from": [
                    "auid"
                  ],
                  "to": "user"
                },
                {
                  "from": [
                    "uid"
                  ],
                  "to": "user.effective"
                },
                {
                  "from": [
                    "id",
                    "acct"
                  ],
                  "to": "user.target"
                }
              ],
              "event": {
                "type": [
                  "user",
                  "deletion"
                ],
                "action": [
                  "deleted-user-account"
                ],
                "category": [
                  "iam"
                ]
              }
            }
          ],
          "VIRT_RESOURCE": [
            {
              "event": {
                "action": [
                  "assigned-vm-resource"
                ],
                "category": [
                  "host"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "USER_TTY": [
            {
              "event": {
                "action": [
                  "typed"
                ]
              }
            }
          ],
          "KERN_MODULE": [
            {
              "event": {
                "category": [
                  "driver"
                ],
                "type": [
                  "start"
                ],
                "action": [
                  "loaded-kernel-module"
                ]
              }
            }
          ],
          "CRYPTO_LOGOUT": [
            {
              "event": {
                "category": [
                  "process"
                ],
                "type": [
                  "info"
                ],
                "action": [
                  "crypto-officer-logged-out"
                ]
              }
            }
          ],
          "ROLE_ASSIGN": [
            {
              "event": {
                "category": [
                  "iam"
                ],
                "type": [
                  "user",
                  "change"
                ],
                "action": [
                  "assigned-user-role-to"
                ]
              }
            }
          ],
          "ANOM_PROMISCUOUS": [
            {
              "event": {
                "action": [
                  "changed-promiscuous-mode-on-device"
                ]
              }
            }
          ],
          "SYSTEM_BOOT": [
            {
              "event": {
                "action": [
                  "booted-system"
                ],
                "category": [
                  "host"
                ],
                "type": [
                  "start"
                ]
              }
            }
          ],
          "CRED_REFR": [
            {
              "copy": [
                {
                  "from": [
                    "auid"
                  ],
                  "to": "user"
                },
                {
                  "from": [
                    "acct",
                    "id",
                    "uid"
                  ],
                  "to": "user.effective"
                }
              ],
              "event": {
                "type": [
                  "info"
                ],
                "action": [
                  "refreshed-credentials"
                ],
                "category": [
                  "authentication"
                ]
              }
            }
          ],
          "USER_ROLE_CHANGE": [
            {
              "event": {
                "action": [
                  "changed-role-to"
                ]
              }
            }
          ],
          "ROLE_MODIFY": [
            {
              "event": {
                "type": [
                  "change"
                ],
                "action": [
                  "modified-role"
                ],
                "category": [
                  "iam"
                ]
              }
            }
          ],
          "TEST": [
            {
              "event": {
                "category": [
                  "process"
                ],
                "type": [
                  "info"
                ],
                "action": [
                  "sent-test"
                ]
              }
            }
          ],
          "ANOM_LOGIN_SESSIONS": [
            {
              "event": {
                "action": [
                  "opened-too-many-sessions-to"
                ]
              }
            }
          ],
          "ACCT_LOCK": [
            {
              "event": {
                "action": [
                  "locked-account"
                ],
                "category": [
                  "iam"
                ],
                "type": [
                  "user",
                  "info"
                ]
              }
            }
          ],
          "USER_CMD": [
            {
              "event": {
                "action": [
                  "ran-command"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "start"
                ]
              }
            }
          ],
          "MAC_STATUS": [
            {
              "event": {
                "action": [
                  "changed-selinux-enforcement"
                ],
                "category": [
                  "configuration"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "MAC_CONFIG_CHANGE": [
            {
              "event": {
                "type": [
                  "change"
                ],
                "action": [
                  "changed-selinux-boolean"
                ],
                "category": [
                  "configuration"
                ]
              }
            }
          ],
          "CONFIG_CHANGE": [
            {
              "event": {
                "action": [
                  "changed-audit-configuration"
                ],
                "category": [
                  "process",
                  "configuration"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "DAEMON_RECONFIG": [
            {
              "event": {
                "type": [
                  "info"
                ],
                "action": [
                  "reconfigured-auditd"
                ],
                "category": [
                  "process",
                  "configuration"
                ]
              }
            }
          ],
          "LABEL_OVERRIDE": [
            {
              "event": {
                "action": [
                  "overrode-label-of"
                ]
              }
            }
          ],
          "CHGRP_ID": [
            {
              "event": {
                "action": [
                  "changed-group"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "ANOM_EXEC": [
            {
              "event": {
                "category": [
                  "process"
                ],
                "type": [
                  "start"
                ],
                "action": [
                  "attempted-execution-of-forbidden-program"
                ]
              }
            }
          ],
          "MAC_POLICY_LOAD": [
            {
              "event": {
                "type": [
                  "access"
                ],
                "action": [
                  "loaded-selinux-policy"
                ],
                "category": [
                  "configuration"
                ]
              }
            }
          ],
          "MAC_CHECK": [
            {
              "event": {
                "action": [
                  "mac-permission"
                ]
              }
            }
          ],
          "USER_MAC_POLICY_LOAD": [
            {
              "event": {
                "category": [
                  "configuration"
                ],
                "type": [
                  "access"
                ],
                "action": [
                  "loaded-mac-policy"
                ]
              }
            }
          ],
          "CRYPTO_SESSION": [
            {
              "event": {
                "action": [
                  "started-crypto-session"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "ANOM_RBAC_INTEGRITY_FAIL": [
            {
              "event": {
                "action": [
                  "tested-file-system-integrity-of"
                ]
              }
            }
          ],
          "FS_RELABEL": [
            {
              "event": {
                "action": [
                  "relabeled-filesystem"
                ]
              }
            }
          ],
          "USYS_CONFIG": [
            {
              "event": {
                "action": [
                  "changed-configuration"
                ],
                "category": [
                  "configuration"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "USER_CHAUTHTOK": [
            {
              "copy": [
                {
                  "from": [
                    "auid"
                  ],
                  "to": "user"
                },
                {
                  "from": [
                    "uid"
                  ],
                  "to": "user.effective"
                },
                {
                  "to": "user.target",
                  "from": [
                    "acct",
                    "id",
                    "uid"
                  ]
                }
              ],
              "event": {
                "type": [
                  "user",
                  "change"
                ],
                "action": [
                  "changed-password"
                ],
                "category": [
                  "iam"
                ]
              }
            }
          ],
          "AVC": [
            {
              "event": {
                "action": [
                  "violated-selinux-policy"
                ]
              },
              "has_fields": [
                "seresult"
              ]
            },
            {
              "has_fields": [
                "apparmor"
              ],
              "event": {
                "action": [
                  "violated-apparmor-policy"
                ]
              }
            }
          ],
          "USER_LOGOUT": [
            {
              "copy": [
                {
                  "from": [
                    "auid"
                  ],
                  "to": "user"
                },
                {
                  "from": [
                    "acct",
                    "id",
                    "uid"
                  ],
                  "to": "user.effective"
                }
              ],
              "event": {
                "action": [
                  "logged-out"
                ],
                "category": [
                  "authentication"
                ],
                "type": [
                  "end"
                ]
              }
            }
          ],
          "USER_ACCT": [
            {
              "event": {
                "action": [
                  "was-authorized"
                ],
                "category": [
                  "authentication"
                ],
                "type": [
                  "info"
                ]
              },
              "copy": [
                {
                  "from": [
                    "auid"
                  ],
                  "to": "user"
                },
                {
                  "from": [
                    "acct",
                    "id",
                    "uid"
                  ],
                  "to": "user.effective"
                }
              ]
            }
          ],
          "CHUSER_ID": [
            {
              "event": {
                "category": [
                  "process"
                ],
                "type": [
                  "change"
                ],
                "action": [
                  "changed-user-id"
                ]
              }
            }
          ],
          "DEL_GROUP": [
            {
              "copy": [
                {
                  "to": "user",
                  "from": [
                    "auid"
                  ]
                },
                {
                  "from": [
                    "uid"
                  ],
                  "to": "user.effective"
                },
                {
                  "from": [
                    "id",
                    "acct"
                  ],
                  "to": "group"
                }
              ],
              "event": {
                "action": [
                  "deleted-group-account-from"
                ],
                "category": [
                  "iam"
                ],
                "type": [
                  "group",
                  "deletion"
                ]
              }
            }
          ],
          "ANOM_ABEND": [
            {
              "event": {
                "action": [
                  "crashed-program"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "end"
                ]
              }
            }
          ],
          "USER_LOGIN": [
            {
              "copy": [
                {
                  "to": "user",
                  "from": [
                    "auid"
                  ]
                },
                {
                  "from": [
                    "acct",
                    "id",
                    "uid"
                  ],
                  "to": "user.effective"
                }
              ],
              "event": {
                "category": [
                  "authentication"
                ],
                "type": [
                  "start"
                ],
                "action": [
                  "logged-in"
                ]
              }
            }
          ],
          "DAEMON_RESUME": [
            {
              "event": {
                "action": [
                  "resumed-audit-logging"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "ADD_GROUP": [
            {
              "copy": [
                {
                  "from": [
                    "auid"
                  ],
                  "to": "user"
                },
                {
                  "to": "user.effective",
                  "from": [
                    "uid"
                  ]
                },
                {
                  "from": [
                    "id",
                    "acct"
                  ],
                  "to": "group"
                }
              ],
              "event": {
                "type": [
                  "group",
                  "creation"
                ],
                "action": [
                  "added-group-account-to"
                ],
                "category": [
                  "iam"
                ]
              }
            }
          ],
          "SYSTEM_SHUTDOWN": [
            {
              "event": {
                "action": [
                  "shutdown-system"
                ],
                "category": [
                  "host"
                ],
                "type": [
                  "end"
                ]
              }
            }
          ],
          "USER_END": [
            {
              "copy": [
                {
                  "from": [
                    "auid"
                  ],
                  "to": "user"
                },
                {
                  "from": [
                    "acct",
                    "id",
                    "uid"
                  ],
                  "to": "user.effective"
                }
              ],
              "event": {
                "action": [
                  "ended-session"
                ],
                "category": [
                  "session"
                ],
                "type": [
                  "end"
                ]
              }
            }
          ],
          "SELINUX_ERR": [
            {
              "event": {
                "action": [
                  "caused-mac-policy-error"
                ]
              }
            }
          ],
          "CRYPTO_LOGIN": [
            {
              "event": {
                "action": [
                  "crypto-officer-logged-in"
                ]
              }
            }
          ],
          "DAEMON_ROTATE": [
            {
              "event": {
                "type": [
                  "change"
                ],
                "action": [
                  "rotated-audit-logs"
                ],
                "category": [
                  "process"
                ]
              }
            }
          ],
          "TRUSTED_APP": [
            {
              "event": {
                "type": [
                  "info"
                ],
                "action": [
                  "unknown"
                ],
                "category": [
                  "process"
                ]
              }
            }
          ],
          "SERVICE_STOP": [
            {
              "event": {
                "category": [
                  "process"
                ],
                "type": [
                  "stop"
                ],
                "action": [
                  "stopped-service"
                ]
              }
            }
          ],
          "SECCOMP": [
            {
              "event": {
                "action": [
                  "violated-seccomp-policy"
                ]
              }
            }
          ],
          "DAEMON_ERR": [
            {
              "event": {
                "action": [
                  "audit-error"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "DAEMON_ABORT": [
            {
              "event": {
                "action": [
                  "aborted-auditd-startup"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "stop"
                ]
              }
            }
          ],
          "FEATURE_CHANGE": [
            {
              "event": {
                "action": [
                  "changed-audit-feature"
                ],
                "category": [
                  "configuration"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "VIRT_MACHINE_ID": [
            {
              "event": {
                "action": [
                  "assigned-vm-id"
                ],
                "category": [
                  "host"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "KERNEL": [
            {
              "event": {
                "category": [
                  "process"
                ],
                "type": [
                  "info"
                ],
                "action": [
                  "initialized-audit-subsystem"
                ]
              }
            }
          ],
          "DAEMON_END": [
            {
              "event": {
                "action": [
                  "shutdown-audit"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "stop"
                ]
              }
            }
          ],
          "ANOM_LOGIN_FAILURES": [
            {
              "event": {
                "action": [
                  "failed-log-in-too-many-times-to"
                ]
              }
            }
          ],
          "USER_AUTH": [
            {
              "copy": [
                {
                  "from": [
                    "auid"
                  ],
                  "to": "user"
                },
                {
                  "from": [
                    "acct",
                    "id",
                    "uid"
                  ],
                  "to": "user.effective"
                }
              ],
              "event": {
                "action": [
                  "authenticated"
                ],
                "category": [
                  "authentication"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "TTY": [
            {
              "event": {
                "action": [
                  "typed"
                ]
              }
            }
          ],
          "VIRT_CREATE": [
            {
              "event": {
                "action": [
                  "created-vm-image"
                ],
                "category": [
                  "host"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "SOFTWARE_UPDATE": [
            {
              "event": {
                "action": [
                  "package-updated"
                ],
                "category": [
                  "package"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "ACCT_UNLOCK": [
            {
              "event": {
                "action": [
                  "unlocked-account"
                ],
                "category": [
                  "iam"
                ],
                "type": [
                  "user",
                  "info"
                ]
              }
            }
          ],
          "USER": [
            {
              "event": {
                "action": [
                  "sent-message"
                ]
              }
            }
          ],
          "ANOM_LOGIN_LOCATION": [
            {
              "event": {
                "action": [
                  "attempted-log-in-from-unusual-place-to"
                ]
              }
            }
          ],
          "CRYPTO_KEY_USER": [
            {
              "event": {
                "action": [
                  "negotiated-crypto-key"
                ],
                "category": [
                  "process"
                ],
                "type": [
                  "info"
                ]
              }
            }
          ],
          "DAEMON_CLOSE": [
            {
              "event": {
                "action": [
                  "remote-audit-disconnected"
                ],
                "category": [
                  "network"
                ],
                "type": [
                  "connection",
                  "start"
                ]
              }
            }
          ],
          "USER_MAC_CONFIG_CHANGE": [
            {
              "event": {
                "action": [
                  "changed-mac-configuration"
                ],
                "category": [
                  "configuration"
                ],
                "type": [
                  "change"
                ]
              }
            }
          ],
          "ADD_USER": [
            {
              "copy": [
                {
                  "from": [
                    "auid"
                  ],
                  "to": "user"
                },
                {
                  "from": [
                    "uid"
                  ],
                  "to": "user.effective"
                },
                {
                  "from": [
                    "id",
                    "acct"
                  ],
                  "to": "user.target"
                }
              ],
              "event": {
                "action": [
                  "added-user-account"
                ],
                "category": [
                  "iam"
                ],
                "type": [
                  "user",
                  "creation"
                ]
              }
            }
          ]
        }
      },
      "source": "boolean hasFields(HashMap base, def list) {\n  if (list == null) return true;\n  for (int i=0; i<list.length; i++)\n    if (base[list[i]] == null) return false;\n  return true;\n} if (ctx?.auditd?.log?.record_type == null) {\n  return;\n} HashMap base = ctx.auditd.log; def acts = params.types.get(base.record_type); if (acts == null && base.syscall != null) {\n  acts = params.syscalls.get(base?.syscall);\n  if (acts == null) acts = params.syscalls.get('*');\n} if (acts == null) return; def act = null; for (int i=0; act == null && i<acts.length; i++) {\n  if (hasFields(base, acts[i][\"has_fields\"])) act = acts[i];\n}\nif (act?.event != null) {\n  def hm = new HashMap(act.event);\n  hm.forEach((k, v) -> ctx.event[k] = v);\n} if (act?.copy != null) {\n  List lst = new ArrayList();\n  for(int i=0; i<act.copy.length; i++) {\n    def value;\n    def srcList = act.copy[i][\"from\"];\n    for (int j=0; value == null && j<srcList.length; j++) {\n      value = base[srcList[j]];\n    }\n    if (value != null && value instanceof String) {\n      String suffix = value ==~ /[0-9]+/? \".id\" : \".name\";\n      lst.add([\n        \"target\": act.copy[i][\"to\"] + suffix,\n        \"value\": value\n      ]);\n    }\n  }\n  if (lst.size() > 0) {\n    ctx.auditd.log[\"copy\"] = lst;\n  }\n}"
    }
  },
  {
    "foreach": {
      "processor": {
        "set": {
          "value": "{{_ingest._value.value}}",
          "field": "{{_ingest._value.target}}"
        }
      },
      "field": "auditd.log.copy",
      "ignore_missing": true
    }
  },
  {
    "set": {
      "field": "event.category",
      "value": "host",
      "if": "ctx.auditd.log?.record_type == 'SYSTEM_BOOT' || ctx.auditd.log?.record_type == 'SYSTEM_SHUTDOWN'"
    }
  },
  {
    "set": {
      "field": "event.type",
      "value": "info",
      "if": "ctx.auditd.log?.record_type == 'SYSTEM_BOOT' || ctx.auditd.log?.record_type == 'SYSTEM_SHUTDOWN'"
    }
  },
  {
    "set": {
      "if": "ctx.auditd.log?.record_type == 'SYSCALL' && ctx.auditd.log?.syscall == 'execve'",
      "field": "event.category",
      "value": "process"
    }
  },
  {
    "set": {
      "if": "ctx.auditd.log?.record_type == 'SYSCALL' && ctx.auditd.log?.syscall == 'execve'",
      "field": "event.type",
      "value": "info"
    }
  },
  {
    "set": {
      "if": "ctx.auditd.log?.record_type == 'VIRT_CONTROL' || ctx.auditd.log?.record_type == 'VIRT_MACHINE_ID'",
      "field": "event.category",
      "value": "host"
    }
  },
  {
    "set": {
      "if": "ctx.auditd.log?.record_type == 'VIRT_CONTROL' && ctx.auditd.log?.op == 'start'",
      "field": "event.type",
      "value": "start"
    }
  },
  {
    "set": {
      "field": "event.type",
      "value": "end",
      "if": "ctx.auditd.log?.record_type == 'VIRT_CONTROL' && ctx.auditd.log?.op == 'stop'"
    }
  },
  {
    "set": {
      "if": "ctx.auditd.log?.record_type == 'VIRT_CONTROL' && ctx.auditd.log?.op == 'create'",
      "field": "event.type",
      "value": "creation"
    }
  },
  {
    "set": {
      "if": "ctx.auditd.log?.record_type == 'VIRT_CONTROL' && ctx.auditd.log?.op == 'delete'",
      "field": "event.type",
      "value": "deletion"
    }
  },
  {
    "set": {
      "if": "ctx.auditd.log?.record_type == 'VIRT_MACHINE_ID'",
      "field": "event.type",
      "value": "creation"
    }
  },
  {
    "set": {
      "field": "container.name",
      "value": "{{ auditd.log.vm }}",
      "ignore_empty_value": true,
      "if": "ctx.auditd.log?.record_type == 'VIRT_MACHINE_ID'"
    }
  },
  {
    "set": {
      "if": "ctx.auditd.log?.record_type == 'VIRT_MACHINE_ID'",
      "field": "container.runtime",
      "value": "{{ auditd.log.virt }}",
      "ignore_empty_value": true
    }
  },
  {
    "set": {
      "field": "network.direction",
      "value": "ingress",
      "if": "ctx.auditd.log?.record_type == 'SYSCALL' && ( ctx.auditd.log?.syscall == 'accept' || ctx.auditd.log?.syscall == '43' || ctx.auditd.log?.syscall == 'recvfrom' || ctx.auditd.log?.syscall == '45' || ctx.auditd.log?.syscall == 'recvmsg' || ctx.auditd.log?.syscall == '47' || ctx.auditd.log?.syscall == 'accept4' || ctx.auditd.log?.syscall == '288' )\n"
    }
  },
  {
    "set": {
      "if": "ctx.auditd.log?.record_type == 'SYSCALL' && ( ctx.auditd.log?.syscall == 'connect' || ctx.auditd.log?.syscall == '42' || ctx.auditd.log?.syscall == 'sendto' || ctx.auditd.log?.syscall == '44' || ctx.auditd.log?.syscall == 'sendmsg' || ctx.auditd.log?.syscall == '46')\n",
      "field": "network.direction",
      "value": "egress"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.arch",
      "target_field": "host.architecture"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.acct",
      "target_field": "user.name"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.user",
      "target_field": "user.name"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.uid",
      "target_field": "user.id"
    }
  },
  {
    "rename": {
      "field": "auditd.log.gid",
      "target_field": "user.group.id",
      "ignore_failure": true
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.agid",
      "target_field": "user.audit.group.id"
    }
  },
  {
    "rename": {
      "field": "auditd.log.auid",
      "target_field": "user.audit.id",
      "ignore_failure": true
    }
  },
  {
    "rename": {
      "target_field": "user.filesystem.group.id",
      "ignore_failure": true,
      "field": "auditd.log.fsgid"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.fsuid",
      "target_field": "user.filesystem.id"
    }
  },
  {
    "rename": {
      "target_field": "user.effective.group.id",
      "ignore_failure": true,
      "field": "auditd.log.egid"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.euid",
      "target_field": "user.effective.id"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.sgid",
      "target_field": "user.saved.group.id"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.suid",
      "target_field": "user.saved.id"
    }
  },
  {
    "rename": {
      "target_field": "user.owner.group.id",
      "ignore_failure": true,
      "field": "auditd.log.ogid"
    }
  },
  {
    "rename": {
      "target_field": "user.owner.id",
      "ignore_failure": true,
      "field": "auditd.log.ouid"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.comm",
      "target_field": "process.name"
    }
  },
  {
    "rename": {
      "target_field": "process.executable",
      "ignore_failure": true,
      "field": "auditd.log.exe"
    }
  },
  {
    "rename": {
      "target_field": "process.pid",
      "ignore_failure": true,
      "field": "auditd.log.pid"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.ppid",
      "target_field": "process.parent.pid"
    }
  },
  {
    "convert": {
      "ignore_missing": true,
      "field": "process.pid",
      "type": "long"
    }
  },
  {
    "convert": {
      "ignore_missing": true,
      "field": "process.parent.pid",
      "type": "long"
    }
  },
  {
    "rename": {
      "field": "auditd.log.cmd",
      "target_field": "process.args",
      "ignore_failure": true
    }
  },
  {
    "split": {
      "ignore_failure": true,
      "field": "process.args",
      "separator": "\\s+"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.argc",
      "target_field": "process.args_count"
    }
  },
  {
    "script": {
      "lang": "painless",
      "source": "if (ctx.process.args instanceof List) {\n  ctx.process.args_count = ctx.process.args.length;\n}",
      "if": "ctx?.process?.args != null"
    }
  },
  {
    "convert": {
      "type": "long",
      "ignore_missing": true,
      "field": "process.args_count"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.exit",
      "target_field": "process.exit_code"
    }
  },
  {
    "convert": {
      "field": "process.exit_code",
      "type": "long",
      "ignore_missing": true
    }
  },
  {
    "rename": {
      "ignore_missing": true,
      "field": "auditd.log.cwd",
      "target_field": "process.working_directory"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.terminal",
      "target_field": "user.terminal"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.msg",
      "target_field": "message"
    }
  },
  {
    "script": {
      "lang": "painless",
      "description": "Extracts process arguments from EXECVE calls.",
      "if": "ctx.auditd?.log?.record_type == \"EXECVE\"",
      "source": "/* Want to capture all aNN fields, including aN_len and aN[x] */ Pattern argRegex = /^a([0-9]+)(.*)$/;\nList keys = ctx.auditd.log.keySet().stream()\n            /* From List of keys to list of matchers */\n            .map(x -> argRegex.matcher(x))\n            /* Drop elements that didn't match the regex */\n            .filter(x -> x.matches())\n            /* Must save to a list because it needs to remove keys in auditd.log,\n               which cannot be done while streaming from this source */\n            .collect(Collectors.toList());\n\nList args = keys.stream()\n            /* List<Matcher> to List<[Matcher, Value for given key]>\n               with side effect of removing the key */\n            .map(x -> [x, ctx.auditd.log.remove(x.group(0))])\n            /* Drop elements that end in _len, just wanted to remove them */\n            .filter(x -> x[0].group(2) != \"_len\")\n            /* List<Matcher, Value> to List<[Int, Value]>\n               where the Int is the argument index */\n            .map(x -> [Integer.parseInt(x[0].group(1)), x[1]])\n            /* Sort by numeric argument index */\n            .sorted((lhs, rhs) -> lhs[0].compareTo(rhs[0]))\n            /* Save as List<[Index, Value]> */\n            .collect(Collectors.toList());\n\nif (args.isEmpty()) return; if (ctx.process == null) ctx.process = new HashMap(); ctx.process.args = args.stream().map(x -> x[1]).collect(Collectors.toList()); def firstIndex = args[0][0]; if (firstIndex == 0) {\n  ctx.process.executable = ctx.process.args[0];\n} else {\n  ctx.process.args.add(0, \"[... \" + firstIndex + \" truncated arguments ...]\");\n}",
      "on_failure": [
        {
          "append": {
            "field": "error.message",
            "value": "failed extracting process arguments: {{{ _ingest.on_failure_message }}}"
          }
        }
      ]
    }
  },
  {
    "rename": {
      "field": "auditd.log.res",
      "target_field": "event.outcome",
      "ignore_failure": true
    }
  },
  {
    "rename": {
      "target_field": "event.action",
      "ignore_failure": true,
      "field": "auditd.log.record_type"
    }
  },
  {
    "lowercase": {
      "ignore_failure": true,
      "field": "event.action"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.src",
      "target_field": "source.address"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.addr",
      "target_field": "source.address",
      "if": "ctx?.source?.address == null"
    }
  },
  {
    "rename": {
      "ignore_failure": true,
      "field": "auditd.log.dst",
      "target_field": "destination.address"
    }
  },
  {
    "grok": {
      "patterns": [
        "^%{IP:source.ip}$"
      ],
      "ignore_failure": true,
      "field": "source.address"
    }
  },
  {
    "geoip": {
      "field": "source.ip",
      "target_field": "source.geo",
      "ignore_failure": true
    }
  },
  {
    "geoip": {
      "database_file": "GeoLite2-ASN.mmdb",
      "field": "source.ip",
      "target_field": "source.as",
      "properties": [
        "asn",
        "organization_name"
      ],
      "ignore_missing": true
    }
  },
  {
    "rename": {
      "ignore_missing": true,
      "field": "source.as.asn",
      "target_field": "source.as.number"
    }
  },
  {
    "rename": {
      "target_field": "source.as.organization.name",
      "ignore_missing": true,
      "field": "source.as.organization_name"
    }
  },
  {
    "remove": {
      "field": [
        "auditd.log.kv",
        "auditd.log.sub_kv",
        "auditd.log.epoch",
        "auditd.log.copy"
      ],
      "ignore_failure": true,
      "ignore_missing": true
    }
  }
]
